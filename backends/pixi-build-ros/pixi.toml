[workspace]
channels = [
  "https://prefix.dev/pixi-build-backends",
  "https://prefix.dev/conda-forge",
]
platforms = ["osx-arm64", "win-64", "linux-64"]
preview = ["pixi-build"]

[dependencies]
pydantic = ">=2.8.2,<3"
pixi-build-ros = { path = "." }

[environments]
default = { features = [], solve-group = "default" }
test = { features = ["test"], solve-group = "default" }
lint = { features = ["lint"], no-default-feature = true }

[feature.test.tasks]
test = "pytest tests"
lint-mypy = "mypy"

[feature.test.dependencies]
pixi-pycharm = ">=0.0.8,<0.1"
pytest = "*"
mypy = ">=1.18.2,<2"
types-pyyaml = "*"
# You can skip this as it's a long build, uncomment this when developing only in this package
#py-pixi-build-backend = "*"
py-pixi-build-backend = { path = "../../py-pixi-build-backend" }

[feature.lint.dependencies]
ruff = "*"
pyupgrade = ">=3.20.0,<4"

[feature.lint.tasks]
lint-ruff = "ruff check ."
fmt-pyupgrade = "pyupgrade --py310-plus **/**/*.py"
fmt-ruff = "ruff format src tests"
fmt = { depends-on = ["fmt-pyupgrade", "fmt-ruff"] }

## Package section
[package]
name = "pixi-build-ros"
version = "0.1.3"

[package.build.backend]
name = "pixi-build-python"
version = "*"

[package.host-dependencies]
hatchling = "*"
python = ">=3.10"

[package.run-dependencies]
python = ">=3.10"
rosdistro = "*"
pydantic = ">=2.8.2,<3"
catkin_pkg = "*"
pyyaml = "*"
pixi-build-api-version = ">=2,<3"
# should be added to `py-pixi-build-backend`
typing-extensions = "*"
# this depends has to match the test dependency, so switch comments if needed
# py-pixi-build-backend = "*"
py-pixi-build-backend = { path = "../../py-pixi-build-backend" }
